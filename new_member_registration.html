<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>New Member Registration</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 30px;
      font-size: 20px;
      background-color: #fff8f5;
      color: #4b1c1c;
    }
    h2 {
      font-size: 26px;
      color: maroon;
      margin-top: 30px;
    }
    label {
      display: block;
      margin-top: 15px;
      font-size: 20px;
    }
    input, select, textarea {
      width: 100%;
      padding: 10px;
      font-size: 20px;
      margin-top: 5px;
      border: 1px solid maroon;
      border-radius: 5px;
    }
    .checkbox-group {
      display: flex;
      gap: 30px;
      margin-top: 10px;
      font-size: 20px;
    }
    button {
      margin-top: 30px;
      padding: 15px;
      font-size: 22px;
      background-color: maroon;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #a52a2a;
    }
    #termsBox {
      height: 180px;
      overflow-y: scroll;
      border: 1px solid maroon;
      padding: 15px;
      background-color: #fff;
      margin-top: 10px;
      font-size: 18px;
      scroll-behavior: smooth;
    }
  </style>
</head>
<body>
  <h2>New Member Registration</h2>
  <form id="Members">
    <input type="hidden" name="action" value="registerMember">

    <label>Full Name (as per NRIC)<input name="fullName" required></label>
    <label>Preferred Name (optional)<input name="preferredName"></label>
    <label>Full NRIC<input name="nric" required></label>

    <label>Gender
      <select name="gender" required>
        <option value="">Select</option>
        <option>Female</option>
        <option>Male</option>
      </select>
    </label>

    <label>Date of Birth<input type="date" name="dob" required></label>

    <label>Jersey Size
      <select name="jerseySize" required>
        <option value="">Select</option>
        <option>XS</option><option>S</option><option>M</option>
        <option>L</option><option>XL</option><option>XXL</option><option>XXXL</option>
      </select>
    </label>

    <label>Weight (kg)<input type="number" name="weight" min="30" max="200" required></label>
    <label>Postal Code<input type="number" name="postalCode" required></label>
    <label>Nationality<input name="nationality" required></label>

    <label>Ethnicity
      <select name="ethnicity" required>
        <option value="">Select</option>
        <option>Chinese</option><option>Malay</option><option>Indian</option>
        <option>Eurasian</option><option>Others</option>
      </select>
    </label>

    <label>Contact Number<input type="tel" name="contactNumber" required></label>
    <label>Email Address<input type="email" name="email" required></label>
    <label>Medical History (if any)<textarea name="medicalHistory"></textarea></label>

    <h2>Emergency Contact</h2>
    <label>Name of Emergency Contact<input name="emergencyName" required></label>
    <label>Relationship<input name="relationship" required></label>
    <label>Mobile Number<input type="tel" name="emergencyMobile" required></label>

    <h2>Experience / Certification</h2>
    <label>Paddling Side</label>
    <div class="checkbox-group">
      <label><input type="checkbox" name="paddlingSide" value="LEFT"> LEFT</label>
      <label><input type="checkbox" name="paddlingSide" value="RIGHT"> RIGHT</label>
    </div>

    <label>Certified Helmsman
      <select name="helmsman" required>
        <option value="">Select</option>
        <option>Yes</option><option>No</option>
      </select>
    </label>

    <label>Certified Coach
      <select name="coach" required>
        <option value="">Select</option>
        <option>None</option><option>R1</option><option>L1</option>
        <option>L2</option><option>L3</option>
      </select>
    </label>

    <label>Can you swim? (with Personal Floatation Device)
      <select name="swimAbility" required>
        <option value="">Select</option>
        <option>Yes</option><option>No</option><option>Can swim, cannot tread water</option>
      </select>
    </label>

    <label>SDBA athlete card number (put 'Nil' if don't have one)<input name="sdbaCard"></label>

    <h2>Terms and Conditions</h2>
    <div id="termsBox">
      <p>By registering, you agree to abide by the club's safety rules, training commitments, and code of conduct. You also consent to the collection and use of your personal data for administrative and race-related purposes.</p>
      <p>You acknowledge that paddling is a physically demanding sport and agree to disclose any medical conditions that may affect your participation. You also agree to follow instructions from coaches and team leaders during training and races.</p>
    </div>
    <label><input type="checkbox" id="agreeCheckbox"> I have read and agree to the Terms and Conditions</label>

    <button type="submit">Submit</button>
  </form>

  <div style="text-align: center; margin-top: 40px;">
    <button onclick="location.href='index.html'" style="font-size: 20px; padding: 15px 30px; background-color: maroon; color: white; border: none; border-radius: 5px; cursor: pointer;">
      Back to Home
    </button>
  </div>

  <script>
    const submissionScriptURL = 'https://script.google.com/macros/s/AKfycbzZbYh6Ziw6tmPD02HkVPx2_9dAi1cnUe3jQC0E46kjzMbm7Rha89KFE1viiS8MEXaaFQ/exec';

    const termsBox = document.getElementById('termsBox');
    const agreeCheckbox = document.getElementById('agreeCheckbox');

    termsBox.addEventListener('scroll', () => {
      if (termsBox.scrollTop + termsBox.clientHeight >= termsBox.scrollHeight) {
        agreeCheckbox.disabled = false;
      }
    });

    const form = document.getElementById("Members");

    form.addEventListener("submit", function (e) {
      e.preventDefault();

      if (!agreeCheckbox.checked) {
        alert("Please agree to the Terms and Conditions before submitting.");
        return;
      }

      const formData = new FormData(form);
      const paddlingSides = [];
      form.querySelectorAll('input[name="paddlingSide"]:checked').forEach(cb => paddlingSides.push(cb.value));
      formData.set("paddlingSide", paddlingSides.join(", "));

      const fullName = formData.get("fullName");

      fetch(submissionScriptURL, {
        method: "POST",
        body: formData,
      })
      .then(response => response.text())
      .then(data => {
        if (data === "Success") {
          alert(`Thank you ${fullName}! Your submission has been successful!`);
          form.reset();
          agreeCheckbox.checked = false;
          agreeCheckbox.disabled = true;
          window.location.href = 'index.html';
        } else {
          alert(data);
        }
      })
      .catch(error => {
        alert("There was an error submitting the form.");
        console.error("Submission error:", error);
      });
    });
  </script>
</body>
</html>
